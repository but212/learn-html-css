#!/bin/bash
# Git post-merge hook: ì ˆëŒ€ ê²½ë¡œë¥¼ ìƒëŒ€ ê²½ë¡œë¡œ ë³€í™˜ (src ë° ë£¨íŠ¸ index.html í¬í•¨)

echo "ğŸ”„ Merging into main... Updating paths!"

# ë³€ê²½í•  ëŒ€ìƒ ë””ë ‰í† ë¦¬ ë° íŒŒì¼ ì§€ì •
TARGET_DIR="src"
TARGET_FILE="index.html"
EXTENSIONS=("js" "ts" "html" "css")

# ì ˆëŒ€ ê²½ë¡œ ì°¾ê¸°
ABSOLUTE_PATH=$(realpath "$TARGET_DIR")

# src ë””ë ‰í† ë¦¬ ë‚´ë¶€ì˜ ì ˆëŒ€ ê²½ë¡œ ìˆ˜ì •
find "$TARGET_DIR" -type f \( $(printf -- '-name "*.%s" -o ' "${EXTENSIONS[@]}" | sed 's/ -o $//') \) | while read -r file; do
    echo "ğŸ”„ Updating paths in: $file"
    sed -i "s|$ABSOLUTE_PATH|./$TARGET_DIR|g" "$file"
done

# ë£¨íŠ¸ index.html íŒŒì¼ì— ì ìš©
if [ -f "$TARGET_FILE" ]; then
    echo "ğŸ”„ Updating paths in: $TARGET_FILE"
    sed -i "s|$ABSOLUTE_PATH|./$TARGET_DIR|g" "$TARGET_FILE"
fi

echo "âœ… Paths updated successfully!"
